<model>
    <mount>//OPNsense/Netflow</mount>
    <version>1.0.1</version>
    <description>OPNsense Netflow</description>
    <items>
        <capture>
            <interfaces type="InterfaceField">
                <Multiple>Y</Multiple>
                <filters>
                    <enable>/^(?!0).*$/</enable>
                </filters>
            </interfaces>
            <egress_only type="InterfaceField">
                <Multiple>Y</Multiple>
                <filters>
                    <enable>/^(?!0).*$/</enable>
                </filters>
            </egress_only>
            <version type="OptionField">
                <Required>Y</Required>
                <Default>v9</Default>
                <OptionValues>
                    <v5>v5</v5>
                    <v9>v9</v9>
                </OptionValues>
            </version>
            <targets type="IPPortField">
                <AsList>Y</AsList>
                <AddressFamily>ipv4</AddressFamily>
            </targets>
        </capture>
        <collect>
            <enable type="BooleanField">
                <Default>0</Default>
                <Required>Y</Required>
            </enable>
            <history>
                <FlowInterfaceTotals>
                    <_30 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_30>
                    <_300 type="IntegerField">
                        <default>604800</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>2678400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowInterfaceTotals>
                <FlowDstPortTotals>
                    <_300 type="IntegerField">
                        <default>3600</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowDstPortTotals>
                <FlowSourceAddrTotals>
                    <_300 type="IntegerField">
                        <default>3600</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowSourceAddrTotals>
                <FlowSourceAddrDetails>
                    <_86400 type="IntegerField">
                        <default>5356800</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowSourceAddrDetails>
            </history>
        </collect>
        <activeTimeout type="IntegerField">
            <Default>1800</Default>
            <Required>Y</Required>
            <MinimumValue>1</MinimumValue>
            <MaximumValue>86400</MaximumValue>
            <ValidationMessage>Active timeout needs to be an integer value between 1 and 86400</ValidationMessage>
         </activeTimeout>
         <inactiveTimeout type="IntegerField">
            <Default>15</Default>
            <Required>Y</Required>
            <MinimumValue>1</MinimumValue>
            <MaximumValue>86400</MaximumValue>
            <ValidationMessage>Inactive timeout needs to be an integer value between 1 and 86400</ValidationMessage>
         </inactiveTimeout>
    </items>
</model>
